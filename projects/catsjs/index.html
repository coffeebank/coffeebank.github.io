<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/4c472ffaefe8ebfa-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="https://avatars3.githubusercontent.com/u/23473065"/><link rel="stylesheet" href="/_next/static/css/db19166c1fb6b326.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/6c9015bfdf3d2785.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/bc1646f45069080b.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-68c4a225f475d789.js" crossorigin=""/><script src="/_next/static/chunks/fd9d1056-b4030ef521bf7de1.js" async="" crossorigin=""></script><script src="/_next/static/chunks/2472-6b9295bb2c0ff7e4.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-db59c8a2d3a97fea.js" async="" crossorigin=""></script><script src="/_next/static/chunks/app/not-found-5b9cc586c061ef1a.js" async=""></script><script src="/_next/static/chunks/8326-f7e9eeb8916f06b2.js" async=""></script><script src="/_next/static/chunks/9907-ec9b461539ee1154.js" async=""></script><script src="/_next/static/chunks/1820-e4d914bd3f72f9fa.js" async=""></script><script src="/_next/static/chunks/4612-46811ea44af4856d.js" async=""></script><script src="/_next/static/chunks/app/(coffee-maubot)/layout-d466260fa8a1703d.js" async=""></script><script src="/_next/static/chunks/app/(home)/projects/catsjs/page-07cff52f63091e07.js" async=""></script><title>cats.js | ☕🏦</title><meta name="description" content="A simple, privacy-friendly, self-hosted analytics solution for websites."/><meta name="theme-color" content="#293658"/><meta name="og:image" content="https://coffeebank.netlify.app/home/media/avinash-kumar-TIGDsyy0TK4-unsplash_c01_twitter.jpg"/><meta property="og:title" content="cats.js: Website Analytics"/><meta property="og:description" content="A simple, privacy-friendly, self-hosted analytics solution for websites."/><meta property="og:site_name" content="Coffeebank ☕"/><meta property="og:image" content="https://coffeebank.netlify.app/home/media/avinash-kumar-TIGDsyy0TK4-unsplash_c01_twitter.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="cats.js: Website Analytics"/><meta name="twitter:description" content="A simple, privacy-friendly, self-hosted analytics solution for websites."/><meta name="twitter:image" content="https://coffeebank.netlify.app/home/media/avinash-kumar-TIGDsyy0TK4-unsplash_c01_twitter.jpg"/><link rel="shortcut icon" href="/icon.png"/><link rel="icon" href="/icon.png"/><link rel="apple-touch-icon" href="/icon.png"/><meta name="next-size-adjust"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body class="scroll-smooth __className_54b096"><aside class="hidden sm:block h-screen [&amp;:hover_.cc-sidebar-show]:w-full w-[calc(3.75rem+3px)] sm:w-[4.75rem] hover:w-[264px] lg:w-[264px] fixed overflow-hidden transition-all duration-300 bg-white dark:bg-[#242424] z-50"><div class="h-full flex flex-col border-r-[0.2rem] border-black/[0.02] dark:border-white/[0.02] "><div class="h-full p-[0.125rem] pb-2 sm:p-2 overflow-y-auto overflow-x-hidden" aria-label="Sidebar Navigation"><div class="grid grid-cols-1 gap-6 px-1 pt-6 pb-3 min-h-40 lg:px-3"><a href="/"><img src="https://avatars3.githubusercontent.com/u/23473065" class="object-cover w-16 rounded-lg select-none lg-16 sm:w-12 sm:h-12 border-1 lg:h-16 lg:w-16" alt="Coffeebank Website"/></a><div class="flex text-lg font-medium leading-6 transition-all duration-300 flex-no-wrap text-black/80 dark:text-white/90" aria-label="Header Info"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-6 w-6 hidden sm:block lg:hidden items-center self-center ml-3 mr-3 flex-none basis-[1.5rem]"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path></svg><div class="overflow-hidden self-center w-0 transition-all duration-300 cc-sidebar-show lg:w-full line-clamp-1" title="Coffeebank">Coffeebank</div></div></div><nav class="px-1 pt-3 lg:pb-6"><a tabindex="0" href="/"><div class="flex items-center px-2 mb-1 rounded-md transition-all duration-300 flex-no-wrap justify-left sm:mb-2 bg-transparent hover:bg-black/[0.03] dark:hover:bg-white/[0.04] text-black/50 dark:text-white/75"><div class="flex justify-center items-center self-center my-3 mr-4 ml-1 lg:ml-2 sm:my-2"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-6 h-6 transition-all duration-300 text-black/40 dark:text-white/60"><path stroke-linecap="round" stroke-linejoin="round" d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"></path></svg></div><div class="overflow-hidden justify-center items-center self-center w-0 text-sm font-medium truncate transition-all duration-300 cc-sidebar-show lg:w-full">Home</div></div></a><a tabindex="0" href="/projects/"><div class="flex items-center px-2 mb-1 rounded-md transition-all duration-300 flex-no-wrap justify-left sm:mb-2 bg-black/[0.04] dark:bg-white/[0.08] hover:bg-black/[0.08] text-black/90 dark:text-white"><div class="flex justify-center items-center self-center my-3 mr-4 ml-1 lg:ml-2 sm:my-2"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-6 h-6 transition-all duration-300 text-black/90 dark:text-white/90"><path stroke-linecap="round" stroke-linejoin="round" d="M20.25 14.15v4.25c0 1.094-.787 2.036-1.872 2.18-2.087.277-4.216.42-6.378.42s-4.291-.143-6.378-.42c-1.085-.144-1.872-1.086-1.872-2.18v-4.25m16.5 0a2.18 2.18 0 0 0 .75-1.661V8.706c0-1.081-.768-2.015-1.837-2.175a48.114 48.114 0 0 0-3.413-.387m4.5 8.006c-.194.165-.42.295-.673.38A23.978 23.978 0 0 1 12 15.75c-2.648 0-5.195-.429-7.577-1.22a2.016 2.016 0 0 1-.673-.38m0 0A2.18 2.18 0 0 1 3 12.489V8.706c0-1.081.768-2.015 1.837-2.175a48.111 48.111 0 0 1 3.413-.387m7.5 0V5.25A2.25 2.25 0 0 0 13.5 3h-3a2.25 2.25 0 0 0-2.25 2.25v.894m7.5 0a48.667 48.667 0 0 0-7.5 0M12 12.75h.008v.008H12v-.008Z"></path></svg></div><div class="overflow-hidden justify-center items-center self-center w-0 text-sm font-medium truncate transition-all duration-300 cc-sidebar-show lg:w-full">Projects</div></div></a><a tabindex="0" href="/blog/"><div class="flex items-center px-2 mb-1 rounded-md transition-all duration-300 flex-no-wrap justify-left sm:mb-2 bg-transparent hover:bg-black/[0.03] dark:hover:bg-white/[0.04] text-black/50 dark:text-white/75"><div class="flex justify-center items-center self-center my-3 mr-4 ml-1 lg:ml-2 sm:my-2"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-6 h-6 transition-all duration-300 text-black/40 dark:text-white/60"><path stroke-linecap="round" stroke-linejoin="round" d="M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 0 1-2.25 2.25M16.5 7.5V18a2.25 2.25 0 0 0 2.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 0 0 2.25 2.25h13.5M6 7.5h3v3H6v-3Z"></path></svg></div><div class="overflow-hidden justify-center items-center self-center w-0 text-sm font-medium truncate transition-all duration-300 cc-sidebar-show lg:w-full">Blog</div></div></a><div class="mx-auto mt-4 mb-2 w-full rounded"><hr role="separator" aria-orientation="horizontal" class="pb-2 border-black/[0.04] dark:border-white/[0.04] block max-w-full h-0 border-solid border-t-2"/></div><a tabindex="0" href="/about/"><div class="flex items-center px-2 mb-1 rounded-md transition-all duration-300 flex-no-wrap justify-left sm:mb-2 bg-transparent hover:bg-black/[0.03] dark:hover:bg-white/[0.04] text-black/50 dark:text-white/75"><div class="flex justify-center items-center self-center my-3 mr-4 ml-1 lg:ml-2 sm:my-2"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-6 h-6 transition-all duration-300 text-black/40 dark:text-white/60"><path stroke-linecap="round" stroke-linejoin="round" d="M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"></path></svg></div><div class="overflow-hidden justify-center items-center self-center w-0 text-sm font-medium truncate transition-all duration-300 cc-sidebar-show lg:w-full">About</div></div></a></nav></div><div class="p-[0.125rem] bg-black/[0.01] dark:bg-white/[0.02] transition-all duration-300"><div class="flex gap-2 justify-between items-center p-3 lg:px-2"><div class="flex gap-2 px-2 sm:pr-6 lg:pr-2"><button class="flex justify-center items-center w-7 h-7 align-middle" aria-label="Toggle Light/Dark Theme"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="mx-auto w-auto h-6 transition-all animate-rotate45-enter dark:text-white/90 text-black/90"><path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z"></path></svg></button></div><a href="/about/"><span class="text-xs truncate text-black/80 dark:text-white/70" title="©️ Coffeebank (☕🏛)">© <!-- -->2024<!-- -->, <!-- -->☕🏛</span></a></div></div></div></aside><aside class="sm:hidden w-full h-bottombar-mini xxs:h-bottombar fixed bottom-0 overflow-y-hidden overflow-x-auto transition-all duration-300 z-50 bg-white dark:bg-[#242424]"><nav class="w-full min-w-[14rem] grid grid-flow-col auto-cols-fr border-r-[0.2rem] border-black/[0.02] dark:border-white/[0.02]"><a tabindex="0" href="/"><div class="flex flex-col px-2 xxs:p-2 w-full text-center [&amp;:hover_.style-icon-component-active]:px-6 [&amp;:hover_.style-icon-component-inactive]:px-5 [&amp;:hover_.style-icon-component-inactive]:bg-black/5 [&amp;:hover_.style-icon-component-inactive]:dark:bg-white/10  [&amp;_.style-icon-component-inactive]:focus:bg-black/5 [&amp;_.style-icon-component-inactive]:focus:dark:bg-white/10"><div class="transition-all duration-300 px-5 py-1 flex justify-center items-center self-center rounded-full style-icon-component-inactive"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="hidden w-5 h-5 transition-all duration-300 xxs:block text-black/90 dark:text-white/90"><path stroke-linecap="round" stroke-linejoin="round" d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"></path></svg></div><h2 class="h-6 py-[0.1rem] text-sm transition-all duration-300 truncate text-black/80 dark:text-white/80" title="Home">Home</h2></div></a><a tabindex="0" href="/projects/"><div class="flex flex-col px-2 xxs:p-2 w-full text-center [&amp;:hover_.style-icon-component-active]:px-6 [&amp;:hover_.style-icon-component-inactive]:px-5 [&amp;:hover_.style-icon-component-inactive]:bg-black/5 [&amp;:hover_.style-icon-component-inactive]:dark:bg-white/10  [&amp;_.style-icon-component-inactive]:focus:bg-black/5 [&amp;_.style-icon-component-inactive]:focus:dark:bg-white/10"><div class="transition-all duration-300 px-5 py-1 flex justify-center items-center self-center rounded-full style-icon-component-active bg-black/10 dark:bg-white/20"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="hidden w-5 h-5 transition-all duration-300 xxs:block text-black/90 dark:text-white/90"><path stroke-linecap="round" stroke-linejoin="round" d="M20.25 14.15v4.25c0 1.094-.787 2.036-1.872 2.18-2.087.277-4.216.42-6.378.42s-4.291-.143-6.378-.42c-1.085-.144-1.872-1.086-1.872-2.18v-4.25m16.5 0a2.18 2.18 0 0 0 .75-1.661V8.706c0-1.081-.768-2.015-1.837-2.175a48.114 48.114 0 0 0-3.413-.387m4.5 8.006c-.194.165-.42.295-.673.38A23.978 23.978 0 0 1 12 15.75c-2.648 0-5.195-.429-7.577-1.22a2.016 2.016 0 0 1-.673-.38m0 0A2.18 2.18 0 0 1 3 12.489V8.706c0-1.081.768-2.015 1.837-2.175a48.111 48.111 0 0 1 3.413-.387m7.5 0V5.25A2.25 2.25 0 0 0 13.5 3h-3a2.25 2.25 0 0 0-2.25 2.25v.894m7.5 0a48.667 48.667 0 0 0-7.5 0M12 12.75h.008v.008H12v-.008Z"></path></svg></div><h2 class="h-6 py-[0.1rem] text-sm transition-all duration-300 truncate font-medium text-black/90 dark:text-white/90" title="Projects">Projects</h2></div></a><a tabindex="0" href="/blog/"><div class="flex flex-col px-2 xxs:p-2 w-full text-center [&amp;:hover_.style-icon-component-active]:px-6 [&amp;:hover_.style-icon-component-inactive]:px-5 [&amp;:hover_.style-icon-component-inactive]:bg-black/5 [&amp;:hover_.style-icon-component-inactive]:dark:bg-white/10  [&amp;_.style-icon-component-inactive]:focus:bg-black/5 [&amp;_.style-icon-component-inactive]:focus:dark:bg-white/10"><div class="transition-all duration-300 px-5 py-1 flex justify-center items-center self-center rounded-full style-icon-component-inactive"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="hidden w-5 h-5 transition-all duration-300 xxs:block text-black/90 dark:text-white/90"><path stroke-linecap="round" stroke-linejoin="round" d="M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 0 1-2.25 2.25M16.5 7.5V18a2.25 2.25 0 0 0 2.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 0 0 2.25 2.25h13.5M6 7.5h3v3H6v-3Z"></path></svg></div><h2 class="h-6 py-[0.1rem] text-sm transition-all duration-300 truncate text-black/80 dark:text-white/80" title="Blog">Blog</h2></div></a><button title="Toggle Menu Sidebar" aria-label="Toggle Menu Sidebar" aria-expanded="false" class="[&amp;:hover_.style-sidebar-modal-active]:dark:bg-white/15 [&amp;:hover_.style-sidebar-modal-inactive]:bg-black/5 [&amp;:hover_.style-sidebar-modal-inactive]:dark:bg-white/10 [&amp;_.style-sidebar-modal-inactive]:focus:bg-black/5 [&amp;_.style-sidebar-modal-inactive]:focus:dark:bg-white/10"><div class="flex justify-center items-center"><div class="transition-all duration-300 p-2 rounded-lg style-sidebar-modal-inactive"><div class="flex flex-nowrap gap-1 justify-center items-center"><img src="https://avatars3.githubusercontent.com/u/23473065" class="object-cover w-full rounded-lg select-none max-w-[2.25rem] aspect-square border-1" alt="Coffeebank Website"/></div></div></div></button></nav></aside><div class="sm:hidden fixed top-0 left-0 z-40 w-full h-screen transition-all duration-300 opacity-100 scale(1) px-2 bg-white dark:bg-[#242424] !opacity-0 !invisible !scale(0.99) !duration-300 !ease-in-out"><div class="w-full h-bottombar-mini-screen xxs:h-bottombar-screen pb-16 transition-all duration-300 [&amp;_.cc-sidebar-show]:w-full"><div class="w-full h-full rounded-b-lg"><div class="h-full flex flex-col false"><div class="h-full p-[0.125rem] pb-2 sm:p-2 overflow-y-auto overflow-x-hidden" aria-label="Sidebar Navigation"><div class="grid grid-cols-1 gap-6 px-1 pt-6 pb-3 min-h-40 lg:px-3"><a href="/"><img src="https://avatars3.githubusercontent.com/u/23473065" class="object-cover w-16 rounded-lg select-none lg-16 sm:w-12 sm:h-12 border-1 lg:h-16 lg:w-16" alt="Coffeebank Website"/></a><div class="flex text-lg font-medium leading-6 transition-all duration-300 flex-no-wrap text-black/80 dark:text-white/90" aria-label="Header Info"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-6 w-6 hidden sm:block lg:hidden items-center self-center ml-3 mr-3 flex-none basis-[1.5rem]"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path></svg><div class="overflow-hidden self-center w-0 transition-all duration-300 cc-sidebar-show lg:w-full line-clamp-1" title="Coffeebank">Coffeebank</div></div></div><nav class="px-1 pt-3 lg:pb-6"><a tabindex="0" href="/"><div class="flex items-center px-2 mb-1 rounded-md transition-all duration-300 flex-no-wrap justify-left sm:mb-2 bg-transparent hover:bg-black/[0.03] dark:hover:bg-white/[0.04] text-black/50 dark:text-white/75"><div class="flex justify-center items-center self-center my-3 mr-4 ml-1 lg:ml-2 sm:my-2"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-6 h-6 transition-all duration-300 text-black/40 dark:text-white/60"><path stroke-linecap="round" stroke-linejoin="round" d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"></path></svg></div><div class="overflow-hidden justify-center items-center self-center w-0 text-sm font-medium truncate transition-all duration-300 cc-sidebar-show lg:w-full">Home</div></div></a><a tabindex="0" href="/projects/"><div class="flex items-center px-2 mb-1 rounded-md transition-all duration-300 flex-no-wrap justify-left sm:mb-2 bg-black/[0.04] dark:bg-white/[0.08] hover:bg-black/[0.08] text-black/90 dark:text-white"><div class="flex justify-center items-center self-center my-3 mr-4 ml-1 lg:ml-2 sm:my-2"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-6 h-6 transition-all duration-300 text-black/90 dark:text-white/90"><path stroke-linecap="round" stroke-linejoin="round" d="M20.25 14.15v4.25c0 1.094-.787 2.036-1.872 2.18-2.087.277-4.216.42-6.378.42s-4.291-.143-6.378-.42c-1.085-.144-1.872-1.086-1.872-2.18v-4.25m16.5 0a2.18 2.18 0 0 0 .75-1.661V8.706c0-1.081-.768-2.015-1.837-2.175a48.114 48.114 0 0 0-3.413-.387m4.5 8.006c-.194.165-.42.295-.673.38A23.978 23.978 0 0 1 12 15.75c-2.648 0-5.195-.429-7.577-1.22a2.016 2.016 0 0 1-.673-.38m0 0A2.18 2.18 0 0 1 3 12.489V8.706c0-1.081.768-2.015 1.837-2.175a48.111 48.111 0 0 1 3.413-.387m7.5 0V5.25A2.25 2.25 0 0 0 13.5 3h-3a2.25 2.25 0 0 0-2.25 2.25v.894m7.5 0a48.667 48.667 0 0 0-7.5 0M12 12.75h.008v.008H12v-.008Z"></path></svg></div><div class="overflow-hidden justify-center items-center self-center w-0 text-sm font-medium truncate transition-all duration-300 cc-sidebar-show lg:w-full">Projects</div></div></a><a tabindex="0" href="/blog/"><div class="flex items-center px-2 mb-1 rounded-md transition-all duration-300 flex-no-wrap justify-left sm:mb-2 bg-transparent hover:bg-black/[0.03] dark:hover:bg-white/[0.04] text-black/50 dark:text-white/75"><div class="flex justify-center items-center self-center my-3 mr-4 ml-1 lg:ml-2 sm:my-2"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-6 h-6 transition-all duration-300 text-black/40 dark:text-white/60"><path stroke-linecap="round" stroke-linejoin="round" d="M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 0 1-2.25 2.25M16.5 7.5V18a2.25 2.25 0 0 0 2.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 0 0 2.25 2.25h13.5M6 7.5h3v3H6v-3Z"></path></svg></div><div class="overflow-hidden justify-center items-center self-center w-0 text-sm font-medium truncate transition-all duration-300 cc-sidebar-show lg:w-full">Blog</div></div></a><div class="mx-auto mt-4 mb-2 w-full rounded"><hr role="separator" aria-orientation="horizontal" class="pb-2 border-black/[0.04] dark:border-white/[0.04] block max-w-full h-0 border-solid border-t-2"/></div><a tabindex="0" href="/about/"><div class="flex items-center px-2 mb-1 rounded-md transition-all duration-300 flex-no-wrap justify-left sm:mb-2 bg-transparent hover:bg-black/[0.03] dark:hover:bg-white/[0.04] text-black/50 dark:text-white/75"><div class="flex justify-center items-center self-center my-3 mr-4 ml-1 lg:ml-2 sm:my-2"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="w-6 h-6 transition-all duration-300 text-black/40 dark:text-white/60"><path stroke-linecap="round" stroke-linejoin="round" d="M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"></path></svg></div><div class="overflow-hidden justify-center items-center self-center w-0 text-sm font-medium truncate transition-all duration-300 cc-sidebar-show lg:w-full">About</div></div></a></nav></div><div class="p-[0.125rem] bg-black/[0.01] dark:bg-white/[0.02] transition-all duration-300"><div class="flex gap-2 justify-between items-center p-3 lg:px-2"><div class="flex gap-2 px-2 sm:pr-6 lg:pr-2"><button class="flex justify-center items-center w-7 h-7 align-middle" aria-label="Toggle Light/Dark Theme"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="mx-auto w-auto h-6 transition-all animate-rotate45-enter dark:text-white/90 text-black/90"><path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z"></path></svg></button></div><a href="/about/"><span class="text-xs truncate text-black/80 dark:text-white/70" title="©️ Coffeebank (☕🏛)">© <!-- -->2024<!-- -->, <!-- -->☕🏛</span></a></div></div></div></div></div></div><main class="h-bottombar-mini-screen xxs:h-bottombar-screen sm:h-screen overflow-y-auto w-full sm:pl-[4.75rem] lg:pl-[264px] transition-all duration-300 bg-black/[0.03] dark:bg-black/[0.97]" aria-label="Page contents" id="main"><div style="opacity:0;transform:scale(0.99);transition-property:all"><div class="px-5 xs:px-6 sm:px-12 lg:px-16 pt-4 xl:pt-6 pb-20 max-w-[1200px] mx-auto"><div class="flex flex-nowrap items-stretch pt-8 xl:pt-10 pb-8 xl:pb-10 gap-x-8 xl:gap-x-12"><div class="hidden overflow-hidden flex-none rounded-2xl md:block basis-2/5"><div class="h-full text-gray-100 bg-center bg-cover" style="background-image:url(https://coffeebank.netlify.app/home/media/avinash-kumar-TIGDsyy0TK4-unsplash_c01.jpg)" aria-hidden="true"></div></div><div class="grow"><div class="md:hidden w-full h-[200px] rounded-xl bg-cover bg-center mb-4" style="background-image:url(https://coffeebank.netlify.app/home/media/avinash-kumar-TIGDsyy0TK4-unsplash_c01.jpg)" aria-hidden="true"></div><div class="flex flex-nowrap gap-x-3 items-center pt-2 pb-6 align-middle sm:gap-x-6 md:pt-0"><a class="h-10 w-10 p-[0.625rem] hover:bg-gray-400/30 rounded transition duration-300" href="/projects/"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="transition-all duration-300 text-black/40 dark:text-white/60"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg></a><h1 class="text-xl font-medium xs:text-2xl text-black/90 dark:text-white/90"><span class="mr-4 select-none">☕</span>The Coffeebank Family</h1></div><div class="px-4 pt-2 pb-2"><h1 class="text-3xl font-medium text-black/90 dark:text-white/90">cats.js</h1><h2 class="text-xl text-black/[0.65] dark:text-white/80">Website Analytics</h2><h3 class="pt-6 text-lg text-gray-700/80 dark:text-gray-300/80">A simple, privacy-friendly, self-hosted analytics solution for websites.</h3><hr class="w-24 mt-8 border-black/[0.12] dark:border-white/20"/></div></div></div><article class="pt-4 mx-auto max-w-3xl markdown-css xl:pt-6 text-black/90 dark:text-white/90"><h1>The Case Study 🐈</h1>
<p>While making websites, I found that I happened to need only three things analytics-wise:</p>
<ul>
<li><strong>Time of site visit:</strong> Am I getting a flood of traffic at a certain time?</li>
<li><strong>User agent:</strong> What browsers do I need to prioritize? Are there a lot of Mobile Safari users?</li>
<li><strong>Pages visited:</strong> What is a normal user journey like? Are they running into 404 pages frequently?</li>
</ul>
<p>The most important was the last one. I needed to know specifically <strong>if users were getting stuck</strong> moving from one page to another, not only basic page view counts.</p>
<p>However, many of the market solutions were either not enough, or too much. <a href="https://microanalytics.io/" target="_blank" rel="noopener" class="inline">Microanalytics.io<span class="inline pl-1 select-none aria-hidden"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="inline w-3 h-3"><path fill-rule="evenodd" d="M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Z" clip-rule="evenodd"></path><path fill-rule="evenodd" d="M6.194 12.753a.75.75 0 0 0 1.06.053L16.5 4.44v2.81a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0 0 1.5h2.553l-9.056 8.194a.75.75 0 0 0-.053 1.06Z" clip-rule="evenodd"></path></svg></span></a> and <a href="https://beampipe.io/" target="_blank" rel="noopener" class="inline">Beampipe<span class="inline pl-1 select-none aria-hidden"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="inline w-3 h-3"><path fill-rule="evenodd" d="M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Z" clip-rule="evenodd"></path><path fill-rule="evenodd" d="M6.194 12.753a.75.75 0 0 0 1.06.053L16.5 4.44v2.81a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0 0 1.5h2.553l-9.056 8.194a.75.75 0 0 0-.053 1.06Z" clip-rule="evenodd"></path></svg></span></a> were nice, but didn&#x27;t track sessions. <a href="https://matomo.org/" target="_blank" rel="noopener" class="inline">Matomo<span class="inline pl-1 select-none aria-hidden"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="inline w-3 h-3"><path fill-rule="evenodd" d="M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Z" clip-rule="evenodd"></path><path fill-rule="evenodd" d="M6.194 12.753a.75.75 0 0 0 1.06.053L16.5 4.44v2.81a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0 0 1.5h2.553l-9.056 8.194a.75.75 0 0 0-.053 1.06Z" clip-rule="evenodd"></path></svg></span></a> was too large, and depended on upkeeping a server.</p>
<p>So I decided to build my own. A simple, privacy-friendly analytics solution that logs user trips across pages. Self-hostable, serverless, and scalable.</p>
<h1>Getting Started</h1>
<span id="services"></span><h3><a class="after:content-[&#x27;#&#x27;] after:ml-2 after:invisible hover:after:visible after:font-light after:text-base" href="#services">Services</a></h3>
<ul>
<li>MongoDB (free)</li>
<li>Netlify Functions (free)</li>
</ul>
<p>My approach follows the <a href="https://jamstack.org/" target="_blank" rel="noopener" class="inline">Jamstack philosophy<span class="inline pl-1 select-none aria-hidden"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="inline w-3 h-3"><path fill-rule="evenodd" d="M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Z" clip-rule="evenodd"></path><path fill-rule="evenodd" d="M6.194 12.753a.75.75 0 0 0 1.06.053L16.5 4.44v2.81a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0 0 1.5h2.553l-9.056 8.194a.75.75 0 0 0-.053 1.06Z" clip-rule="evenodd"></path></svg></span></a>. The data is stored in <a href="https://www.mongodb.com/atlas/database" target="_blank" rel="noopener" class="inline">MongoDB<span class="inline pl-1 select-none aria-hidden"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="inline w-3 h-3"><path fill-rule="evenodd" d="M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Z" clip-rule="evenodd"></path><path fill-rule="evenodd" d="M6.194 12.753a.75.75 0 0 0 1.06.053L16.5 4.44v2.81a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0 0 1.5h2.553l-9.056 8.194a.75.75 0 0 0-.053 1.06Z" clip-rule="evenodd"></path></svg></span></a>. To receive and process the write requests, I create an API using <a href="https://www.netlify.com/products/functions/" target="_blank" rel="noopener" class="inline">Netlify Functions<span class="inline pl-1 select-none aria-hidden"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="inline w-3 h-3"><path fill-rule="evenodd" d="M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Z" clip-rule="evenodd"></path><path fill-rule="evenodd" d="M6.194 12.753a.75.75 0 0 0 1.06.053L16.5 4.44v2.81a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0 0 1.5h2.553l-9.056 8.194a.75.75 0 0 0-.053 1.06Z" clip-rule="evenodd"></path></svg></span></a>. Both of these are extremely lightweight and the free tier is plenty for small sites.</p>
<p>On the frontend, a script (hosted statically) is loaded on all pages and runs on every page load. The script caches a timestamp of first load in <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/sessionStorage" target="_blank" rel="noopener" class="inline">SessionStorage<span class="inline pl-1 select-none aria-hidden"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="inline w-3 h-3"><path fill-rule="evenodd" d="M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Z" clip-rule="evenodd"></path><path fill-rule="evenodd" d="M6.194 12.753a.75.75 0 0 0 1.06.053L16.5 4.44v2.81a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0 0 1.5h2.553l-9.056 8.194a.75.75 0 0 0-.053 1.06Z" clip-rule="evenodd"></path></svg></span></a> (which clears when the tab is closed).</p>
<p>Every time the script is run, it sends a POST request to the Netlify Function with the timestamp (as a de-facto session ID) and the basic data I&#x27;m looking for (in this case, the page path and user agent).</p>
<p>On the backend, MongoDB Compass can parse and analyze the data <a href="https://www.mongodb.com/docs/compass/current/schema/" target="_blank" rel="noopener" class="inline">directly from the database<span class="inline pl-1 select-none aria-hidden"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="inline w-3 h-3"><path fill-rule="evenodd" d="M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Z" clip-rule="evenodd"></path><path fill-rule="evenodd" d="M6.194 12.753a.75.75 0 0 0 1.06.053L16.5 4.44v2.81a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0 0 1.5h2.553l-9.056 8.194a.75.75 0 0 0-.053 1.06Z" clip-rule="evenodd"></path></svg></span></a>. You can also always create a frontend for the data in your database. There is full data independence.</p>
<span id="1.-mongodb"></span><h3><a class="after:content-[&#x27;#&#x27;] after:ml-2 after:invisible hover:after:visible after:font-light after:text-base" href="#1.-mongodb">1. MongoDB</a></h3>
<p>Create a database and a collection. Then, create a user scoped to only read/write to that database/collection.</p>
<span id="2.-netlify-functions"></span><h3><a class="after:content-[&#x27;#&#x27;] after:ml-2 after:invisible hover:after:visible after:font-light after:text-base" href="#2.-netlify-functions">2. Netlify Functions</a></h3>
<p>Using GitHub, I create a basic repo with a <code>/netlify/functions/postDb.js</code> file. <a href="https://docs.netlify.com/functions/build/?fn-language=js" target="_blank" rel="noopener" class="inline">Following the Netlify docs<span class="inline pl-1 select-none aria-hidden"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="inline w-3 h-3"><path fill-rule="evenodd" d="M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Z" clip-rule="evenodd"></path><path fill-rule="evenodd" d="M6.194 12.753a.75.75 0 0 0 1.06.053L16.5 4.44v2.81a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0 0 1.5h2.553l-9.056 8.194a.75.75 0 0 0-.053 1.06Z" clip-rule="evenodd"></path></svg></span></a>, I write some code to accept a JSON payload, and then send it into my database.</p>
<p>Note that if your website isn&#x27;t hosted here, you will need to <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS/Errors/CORSMissingAllowOrigin" target="_blank" rel="noopener" class="inline">manually allow the domain(s)<span class="inline pl-1 select-none aria-hidden"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="inline w-3 h-3"><path fill-rule="evenodd" d="M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Z" clip-rule="evenodd"></path><path fill-rule="evenodd" d="M6.194 12.753a.75.75 0 0 0 1.06.053L16.5 4.44v2.81a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0 0 1.5h2.553l-9.056 8.194a.75.75 0 0 0-.053 1.06Z" clip-rule="evenodd"></path></svg></span></a> you&#x27;re using, due to CORS.</p>
<details><summary><code class="cursor-pointer">/netlify/functions/postDb.js</code></summary><pre class="whitespace-normal"><code class="whitespace-pre-wrap">const { MongoClient } = require(&quot;mongodb&quot;);

// To enable CORS
const headers = {
  &#x27;Access-Control-Allow-Origin&#x27;: &#x27;🟨🟨🟨🟨🟨&#x27;,
  &#x27;Access-Control-Allow-Credentials&#x27;: &#x27;true&#x27;,
  &#x27;Access-Control-Allow-Headers&#x27;: &#x27;Content-Type&#x27;,
  &#x27;Access-Control-Allow-Methods&#x27;: &#x27;POST, OPTIONS&#x27;
};

async function postData(jsonSession, jsonTime, jsonUserAgent, jsonPage) {
  const uri = 🟨🟨🟨🟨🟨;
  const client = new MongoClient(uri, {
    useNewUrlParser: true,
    useUnifiedTopology: true,
  });
  try {
    await client.connect();
    const commitData = await client
      .db(&#x27;🟨🟨🟨🟨🟨&#x27;)
      .collection(&#x27;🟨🟨🟨🟨🟨&#x27;)
      .insertOne({
        session: parseInt(jsonSession),
        time: jsonTime,
        useragent: jsonUserAgent,
        page: jsonPage
      })
    return commitData;
  } catch (err) {
    console.log(err); // output to netlify function log
  } finally {
    await client.close();
  }
}

function errOutput(statusCode, err) {
  return {
    statusCode: statusCode,
    headers: {
      &#x27;Access-Control-Allow-Origin&#x27;: &#x27;🟨🟨🟨🟨🟨&#x27;,
      &#x27;Access-Control-Allow-Headers&#x27;: &#x27;Content-Type&#x27;
    },
    body: JSON.stringify({ error: err })
  }
}

exports.handler = async function(event, context) {
  // Add CORS support
  switch (event.httpMethod) {
    case &#x27;POST&#x27;:
      if (!event.body || event.httpMethod !== &#x27;POST&#x27;) {
        return errOutput(500, &quot;No data in json&quot;);
      }
      try {
        const data = JSON.parse(event.body);
        if (!data.sessionId || !data.time || !data.useragent || !data.page ) {
          return errOutput(500, &quot;Improper data in json&quot;);
        }
        const commitData = await postData(data.sessionId, data.time, data.useragent, data.page);
        console.log(commitData);
        return {
          statusCode: 200,
          headers,
          body: &#x27;Success&#x27;
        };
      } catch (error) {
        return {
          statusCode: 500,
          headers,
          body: JSON.stringify({ error: &#x27;Failed&#x27; }),
        };
      }
    case &#x27;OPTIONS&#x27;:
      return {
        statusCode: 200, // &lt;-- Must be 200 otherwise pre-flight call fails
        headers,
        body: &#x27;200&#x27;
      };
  }
};</code></pre></details>
<span id="3.-frontend-script"></span><h3><a class="after:content-[&#x27;#&#x27;] after:ml-2 after:invisible hover:after:visible after:font-light after:text-base" href="#3.-frontend-script">3. Frontend Script</a></h3>
<p>Save this script with your website, then load it on every page. It uses <a href="https://developer.mozilla.org/en-US/docs/Web/API/Navigator/sendBeacon" target="_blank" rel="noopener" class="inline">Navigator.sendBeacon()<span class="inline pl-1 select-none aria-hidden"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="inline w-3 h-3"><path fill-rule="evenodd" d="M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Z" clip-rule="evenodd"></path><path fill-rule="evenodd" d="M6.194 12.753a.75.75 0 0 0 1.06.053L16.5 4.44v2.81a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0 0 1.5h2.553l-9.056 8.194a.75.75 0 0 0-.053 1.06Z" clip-rule="evenodd"></path></svg></span></a> to send data, even after the tab closes.</p>
<p>Note that you can ignore a device by setting &quot;analyticsIgnore&quot; to &quot;true&quot; in LocalStorage. Some adblockers, such as those using EasyPrivacy, may also block Navigator.sendBeacon().</p>
<p>For frameworks (e.g. React, Vue, Svelte), you can set middleware to post a Navigator.sendBeacon() on every route change.</p>
<details><summary><code class="cursor-pointer">index.js</code></summary><pre class="whitespace-normal"><code class="whitespace-pre-wrap">if (JSON.parse(localStorage.getItem(&quot;analyticsIgnore&quot;)) !== &quot;true&quot; &amp;&amp; window.location.hostname !== &quot;localhost&quot;) {
  let varSession;
  let varTime;
  let dateObj;
  let varUserAgent;
  let varPage;

  try {
    // sessionStorage is cleared/reset when tab closes
    // use iso timestamp as session id
    let varId = sessionStorage.getItem(&#x27;varId&#x27;);
    
    if (varId) {
      // ongoing session
      varSession = varId;
      dateObj = new Date();
      varTime = dateObj.toString();
    } else {
      // new session
      dateObj = new Date();
      varSession = Date.parse(dateObj);
      varTime = dateObj.toString();
      sessionStorage.setItem(&quot;varId&quot;, JSON.stringify(varSession));
    }
    console.log(varSession);

    varUserAgent = navigator.userAgent;
    varPage = window.location.pathname;
  } catch (error) {
    console.log({ error });
  }

  // send to database
  try {
    const options = new Blob(
      [JSON.stringify({
        sessionId: parseInt(varSession),
        time: varTime,
        useragent: varUserAgent,
        page: varPage,
      })],
      {type : &#x27;application/json&#x27;}
    );
    navigator.sendBeacon(&#x27;🟨🟨🟨🟨🟨&#x27;, options);
  } catch (error) {
    console.log({ error })
  }
} else {
  console.log(&quot;analyticsIgnore&quot;);
}</code></pre></details>
<h1>Results</h1>
<p>I was pleasantly surprised at how nicely this setup worked. The benefits are great:</p>
<ul>
<li>MongoDB comes with powerful tools, so everything works out-of-the-box.</li>
<li>You own the database, so you have full data independence, and can host it anywhere.</li>
<li>You create the API, so you can easily customize what data you want to collect and store.</li>
<li>Since there is no server, nothing ever goes &quot;out of date&quot;, go &quot;down&quot; for maintenance, or racking up expensive server costs on traffic spikes.</li>
</ul>
<p>This journey has walked us through NoSQL databases, protecting your MongoDB login using Node.js (Netlify Functions), and using browser APIs to persist and send data across pages.</p>
<p>Some enhancements to consider are ratelimiting the Netlify Function, mandating MongoDB schema, and validating data.</p>
<h1>About</h1>
<p>Cats.js stands for &quot;Coffeebank Analytics Tracking Solution - JavaScript&quot;.</p>
<p>Yes, I also happen to like cats.</p>
<p><a href="/projects/catsjs/license/">License: MIT - See License</a>. Hope this is helpful for your analytics needs!</p>
<p class="!text-sm">Last Updated: December 27, 2022</p></article></div></div></main><script src="/_next/static/chunks/webpack-68c4a225f475d789.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"0:\"$L1\"\n"])</script><script>self.__next_f.push([1,"2:HL[\"/_next/static/media/4c472ffaefe8ebfa-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n3:HL[\"/_next/static/css/db19166c1fb6b326.css\",\"style\",{\"crossOrigin\":\"\"}]\n4:HL[\"/_next/static/css/6c9015bfdf3d2785.css\",\"style\",{\"crossOrigin\":\"\"}]\n5:HL[\"/_next/static/css/bc1646f45069080b.css\",\"style\",{\"crossOrigin\":\"\"}]\n"])</script><script>self.__next_f.push([1,"6:I[3728,[],\"\"]\n8:I[9928,[],\"\"]\n9:I[6954,[],\"\"]\na:I[7264,[],\"\"]\nb:I[3619,[\"9160\",\"static/chunks/app/not-found-5b9cc586c061ef1a.js\"],\"\"]\nc:I[2738,[\"8326\",\"static/chunks/8326-f7e9eeb8916f06b2.js\",\"9907\",\"static/chunks/9907-ec9b461539ee1154.js\",\"1820\",\"static/chunks/1820-e4d914bd3f72f9fa.js\",\"4612\",\"static/chunks/4612-46811ea44af4856d.js\",\"8056\",\"static/chunks/app/(coffee-maubot)/layout-d466260fa8a1703d.js\"],\"\"]\nd:I[9929,[\"8326\",\"static/chunks/8326-f7e9eeb8916f06b2.js\",\"9907\",\"static/chunks/9907-ec9b461539ee11"])</script><script>self.__next_f.push([1,"54.js\",\"1820\",\"static/chunks/1820-e4d914bd3f72f9fa.js\",\"4612\",\"static/chunks/4612-46811ea44af4856d.js\",\"8056\",\"static/chunks/app/(coffee-maubot)/layout-d466260fa8a1703d.js\"],\"\"]\ne:I[7336,[\"8326\",\"static/chunks/8326-f7e9eeb8916f06b2.js\",\"9907\",\"static/chunks/9907-ec9b461539ee1154.js\",\"1820\",\"static/chunks/1820-e4d914bd3f72f9fa.js\",\"4612\",\"static/chunks/4612-46811ea44af4856d.js\",\"8056\",\"static/chunks/app/(coffee-maubot)/layout-d466260fa8a1703d.js\"],\"\"]\n10:I[714,[\"8326\",\"static/chunks/8326-f7e9eeb8916f06b2.js\""])</script><script>self.__next_f.push([1,",\"1820\",\"static/chunks/1820-e4d914bd3f72f9fa.js\",\"2576\",\"static/chunks/app/(home)/projects/catsjs/page-07cff52f63091e07.js\"],\"\"]\n11:I[6193,[\"8326\",\"static/chunks/8326-f7e9eeb8916f06b2.js\",\"1820\",\"static/chunks/1820-e4d914bd3f72f9fa.js\",\"2576\",\"static/chunks/app/(home)/projects/catsjs/page-07cff52f63091e07.js\"],\"\"]\n12:I[8326,[\"8326\",\"static/chunks/8326-f7e9eeb8916f06b2.js\",\"1820\",\"static/chunks/1820-e4d914bd3f72f9fa.js\",\"2576\",\"static/chunks/app/(home)/projects/catsjs/page-07cff52f63091e07.js\"],\"\"]\n13:T891,"])</script><script>self.__next_f.push([1,"const { MongoClient } = require(\"mongodb\");\n\n// To enable CORS\nconst headers = {\n  'Access-Control-Allow-Origin': '🟨🟨🟨🟨🟨',\n  'Access-Control-Allow-Credentials': 'true',\n  'Access-Control-Allow-Headers': 'Content-Type',\n  'Access-Control-Allow-Methods': 'POST, OPTIONS'\n};\n\nasync function postData(jsonSession, jsonTime, jsonUserAgent, jsonPage) {\n  const uri = 🟨🟨🟨🟨🟨;\n  const client = new MongoClient(uri, {\n    useNewUrlParser: true,\n    useUnifiedTopology: true,\n  });\n  try {\n    await client.connect();\n    const commitData = await client\n      .db('🟨🟨🟨🟨🟨')\n      .collection('🟨🟨🟨🟨🟨')\n      .insertOne({\n        session: parseInt(jsonSession),\n        time: jsonTime,\n        useragent: jsonUserAgent,\n        page: jsonPage\n      })\n    return commitData;\n  } catch (err) {\n    console.log(err); // output to netlify function log\n  } finally {\n    await client.close();\n  }\n}\n\nfunction errOutput(statusCode, err) {\n  return {\n    statusCode: statusCode,\n    headers: {\n      'Access-Control-Allow-Origin': '🟨🟨🟨🟨🟨',\n      'Access-Control-Allow-Headers': 'Content-Type'\n    },\n    body: JSON.stringify({ error: err })\n  }\n}\n\nexports.handler = async function(event, context) {\n  // Add CORS support\n  switch (event.httpMethod) {\n    case 'POST':\n      if (!event.body || event.httpMethod !== 'POST') {\n        return errOutput(500, \"No data in json\");\n      }\n      try {\n        const data = JSON.parse(event.body);\n        if (!data.sessionId || !data.time || !data.useragent || !data.page ) {\n          return errOutput(500, \"Improper data in json\");\n        }\n        const commitData = await postData(data.sessionId, data.time, data.useragent, data.page);\n        console.log(commitData);\n        return {\n          statusCode: 200,\n          headers,\n          body: 'Success'\n        };\n      } catch (error) {\n        return {\n          statusCode: 500,\n          headers,\n          body: JSON.stringify({ error: 'Failed' }),\n        };\n      }\n    case 'OPTIONS':\n      return {\n        statusCode: 200, // \u003c-- Must be 200 otherwise pre-flight call fails\n        headers,\n        body: '200'\n      };\n  }\n};"])</script><script>self.__next_f.push([1,"14:T4f6,"])</script><script>self.__next_f.push([1,"if (JSON.parse(localStorage.getItem(\"analyticsIgnore\")) !== \"true\" \u0026\u0026 window.location.hostname !== \"localhost\") {\n  let varSession;\n  let varTime;\n  let dateObj;\n  let varUserAgent;\n  let varPage;\n\n  try {\n    // sessionStorage is cleared/reset when tab closes\n    // use iso timestamp as session id\n    let varId = sessionStorage.getItem('varId');\n    \n    if (varId) {\n      // ongoing session\n      varSession = varId;\n      dateObj = new Date();\n      varTime = dateObj.toString();\n    } else {\n      // new session\n      dateObj = new Date();\n      varSession = Date.parse(dateObj);\n      varTime = dateObj.toString();\n      sessionStorage.setItem(\"varId\", JSON.stringify(varSession));\n    }\n    console.log(varSession);\n\n    varUserAgent = navigator.userAgent;\n    varPage = window.location.pathname;\n  } catch (error) {\n    console.log({ error });\n  }\n\n  // send to database\n  try {\n    const options = new Blob(\n      [JSON.stringify({\n        sessionId: parseInt(varSession),\n        time: varTime,\n        useragent: varUserAgent,\n        page: varPage,\n      })],\n      {type : 'application/json'}\n    );\n    navigator.sendBeacon('🟨🟨🟨🟨🟨', options);\n  } catch (error) {\n    console.log({ error })\n  }\n} else {\n  console.log(\"analyticsIgnore\");\n}"])</script><script>self.__next_f.push([1,"1:[[],[\"$\",\"$L6\",null,{\"buildId\":\"N9fs9zcFq92NLyIxEiws1\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/projects/catsjs/\",\"initialTree\":[\"\",{\"children\":[\"(home)\",{\"children\":[\"projects\",{\"children\":[\"catsjs\",{\"children\":[\"__PAGE__\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[false,\"$L7\"],\"globalErrorComponent\":\"$8\",\"children\":[null,[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":[\"$\",\"$Lb\",null,{}],\"notFoundStyles\":[],\"childProp\":{\"current\":[null,[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"scroll-smooth\",\"children\":[\"$\",\"body\",null,{\"className\":\"scroll-smooth __className_54b096\",\"children\":[[\"$\",\"aside\",null,{\"className\":\"hidden sm:block h-screen [\u0026:hover_.cc-sidebar-show]:w-full w-[calc(3.75rem+3px)] sm:w-[4.75rem] hover:w-[264px] lg:w-[264px] fixed overflow-hidden transition-all duration-300 bg-white dark:bg-[#242424] z-50\",\"children\":[\"$\",\"$Lc\",null,{\"category\":{\"me\":{\"name\":\"Coffeebank\",\"image\":\"https://avatars3.githubusercontent.com/u/23473065\",\"home\":\"/\"},\"main\":[{\"to\":\"/\",\"name\":\"Home\",\"icon\":\"HomeIcon\"},{\"to\":\"/projects/\",\"name\":\"Projects\",\"icon\":\"BriefcaseIcon\"},{\"to\":\"/blog/\",\"name\":\"Blog\",\"icon\":\"NewspaperIcon\"}],\"body\":[{\"to\":\"/about/\",\"name\":\"About\",\"icon\":\"UserCircleIcon\"}]}}]}],[\"$\",\"$Ld\",null,{\"category\":{\"me\":{\"name\":\"Coffeebank\",\"image\":\"https://avatars3.githubusercontent.com/u/23473065\",\"home\":\"/\"},\"main\":[{\"to\":\"/\",\"name\":\"Home\",\"icon\":\"HomeIcon\"},{\"to\":\"/projects/\",\"name\":\"Projects\",\"icon\":\"BriefcaseIcon\"},{\"to\":\"/blog/\",\"name\":\"Blog\",\"icon\":\"NewspaperIcon\"}],\"body\":[{\"to\":\"/about/\",\"name\":\"About\",\"icon\":\"UserCircleIcon\"}]}}],[\"$\",\"main\",null,{\"className\":\"h-bottombar-mini-screen xxs:h-bottombar-screen sm:h-screen overflow-y-auto w-full sm:pl-[4.75rem] lg:pl-[264px] transition-all duration-300 bg-black/[0.03] dark:bg-black/[0.97]\",\"aria-label\":\"Page contents\",\"id\":\"main\",\"children\":[\"$\",\"$Le\",null,{\"children\":[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(home)\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(home)\",\"children\",\"projects\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(home)\",\"children\",\"projects\",\"children\",\"catsjs\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$Lf\",[\"$\",\"div\",null,{\"className\":\"px-5 xs:px-6 sm:px-12 lg:px-16 pt-4 xl:pt-6 pb-20 max-w-[1200px] mx-auto\",\"children\":[[\"$\",\"$L10\",null,{\"title\":\"cats.js\",\"subtitle\":\"Website Analytics\",\"description\":\"A simple, privacy-friendly, self-hosted analytics solution for websites.\",\"image\":\"https://coffeebank.netlify.app/home/media/avinash-kumar-TIGDsyy0TK4-unsplash_c01.jpg\"}],[\"$\",\"$L11\",null,{\"children\":[[\"$\",\"h1\",null,{\"children\":\"The Case Study 🐈\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"While making websites, I found that I happened to need only three things analytics-wise:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Time of site visit:\"}],\" Am I getting a flood of traffic at a certain time?\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"User agent:\"}],\" What browsers do I need to prioritize? Are there a lot of Mobile Safari users?\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Pages visited:\"}],\" What is a normal user journey like? Are they running into 404 pages frequently?\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The most important was the last one. I needed to know specifically \",[\"$\",\"strong\",null,{\"children\":\"if users were getting stuck\"}],\" moving from one page to another, not only basic page view counts.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"However, many of the market solutions were either not enough, or too much. \",[\"$\",\"a\",null,{\"href\":\"https://microanalytics.io/\",\"target\":\"_blank\",\"rel\":\"noopener\",\"className\":\"inline\",\"children\":[\"Microanalytics.io\",[\"$\",\"span\",null,{\"className\":\"inline pl-1 select-none aria-hidden\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 20 20\",\"fill\":\"currentColor\",\"aria-hidden\":\"true\",\"data-slot\":\"icon\",\"aria-labelledby\":\"$undefined\",\"className\":\"inline w-3 h-3\",\"children\":[null,[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Z\",\"clipRule\":\"evenodd\"}],[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M6.194 12.753a.75.75 0 0 0 1.06.053L16.5 4.44v2.81a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0 0 1.5h2.553l-9.056 8.194a.75.75 0 0 0-.053 1.06Z\",\"clipRule\":\"evenodd\"}]]}]}]]}],\" and \",[\"$\",\"a\",null,{\"href\":\"https://beampipe.io/\",\"target\":\"_blank\",\"rel\":\"noopener\",\"className\":\"inline\",\"children\":[\"Beampipe\",[\"$\",\"span\",null,{\"className\":\"inline pl-1 select-none aria-hidden\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 20 20\",\"fill\":\"currentColor\",\"aria-hidden\":\"true\",\"data-slot\":\"icon\",\"aria-labelledby\":\"$undefined\",\"className\":\"inline w-3 h-3\",\"children\":[null,[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Z\",\"clipRule\":\"evenodd\"}],[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M6.194 12.753a.75.75 0 0 0 1.06.053L16.5 4.44v2.81a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0 0 1.5h2.553l-9.056 8.194a.75.75 0 0 0-.053 1.06Z\",\"clipRule\":\"evenodd\"}]]}]}]]}],\" were nice, but didn't track sessions. \",[\"$\",\"a\",null,{\"href\":\"https://matomo.org/\",\"target\":\"_blank\",\"rel\":\"noopener\",\"className\":\"inline\",\"children\":[\"Matomo\",[\"$\",\"span\",null,{\"className\":\"inline pl-1 select-none aria-hidden\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 20 20\",\"fill\":\"currentColor\",\"aria-hidden\":\"true\",\"data-slot\":\"icon\",\"aria-labelledby\":\"$undefined\",\"className\":\"inline w-3 h-3\",\"children\":[null,[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Z\",\"clipRule\":\"evenodd\"}],[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M6.194 12.753a.75.75 0 0 0 1.06.053L16.5 4.44v2.81a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0 0 1.5h2.553l-9.056 8.194a.75.75 0 0 0-.053 1.06Z\",\"clipRule\":\"evenodd\"}]]}]}]]}],\" was too large, and depended on upkeeping a server.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"So I decided to build my own. A simple, privacy-friendly analytics solution that logs user trips across pages. Self-hostable, serverless, and scalable.\"}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"Getting Started\"}],\"\\n\",[[\"$\",\"span\",null,{\"id\":\"services\"}],[\"$\",\"h3\",null,{\"children\":[\"$\",\"$L12\",null,{\"href\":\"#services\",\"className\":\"after:content-['#'] after:ml-2 after:invisible hover:after:visible after:font-light after:text-base\",\"children\":\"Services\"}]}]],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"MongoDB (free)\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Netlify Functions (free)\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"My approach follows the \",[\"$\",\"a\",null,{\"href\":\"https://jamstack.org/\",\"target\":\"_blank\",\"rel\":\"noopener\",\"className\":\"inline\",\"children\":[\"Jamstack philosophy\",[\"$\",\"span\",null,{\"className\":\"inline pl-1 select-none aria-hidden\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 20 20\",\"fill\":\"currentColor\",\"aria-hidden\":\"true\",\"data-slot\":\"icon\",\"aria-labelledby\":\"$undefined\",\"className\":\"inline w-3 h-3\",\"children\":[null,[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Z\",\"clipRule\":\"evenodd\"}],[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M6.194 12.753a.75.75 0 0 0 1.06.053L16.5 4.44v2.81a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0 0 1.5h2.553l-9.056 8.194a.75.75 0 0 0-.053 1.06Z\",\"clipRule\":\"evenodd\"}]]}]}]]}],\". The data is stored in \",[\"$\",\"a\",null,{\"href\":\"https://www.mongodb.com/atlas/database\",\"target\":\"_blank\",\"rel\":\"noopener\",\"className\":\"inline\",\"children\":[\"MongoDB\",[\"$\",\"span\",null,{\"className\":\"inline pl-1 select-none aria-hidden\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 20 20\",\"fill\":\"currentColor\",\"aria-hidden\":\"true\",\"data-slot\":\"icon\",\"aria-labelledby\":\"$undefined\",\"className\":\"inline w-3 h-3\",\"children\":[null,[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Z\",\"clipRule\":\"evenodd\"}],[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M6.194 12.753a.75.75 0 0 0 1.06.053L16.5 4.44v2.81a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0 0 1.5h2.553l-9.056 8.194a.75.75 0 0 0-.053 1.06Z\",\"clipRule\":\"evenodd\"}]]}]}]]}],\". To receive and process the write requests, I create an API using \",[\"$\",\"a\",null,{\"href\":\"https://www.netlify.com/products/functions/\",\"target\":\"_blank\",\"rel\":\"noopener\",\"className\":\"inline\",\"children\":[\"Netlify Functions\",[\"$\",\"span\",null,{\"className\":\"inline pl-1 select-none aria-hidden\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 20 20\",\"fill\":\"currentColor\",\"aria-hidden\":\"true\",\"data-slot\":\"icon\",\"aria-labelledby\":\"$undefined\",\"className\":\"inline w-3 h-3\",\"children\":[null,[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Z\",\"clipRule\":\"evenodd\"}],[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M6.194 12.753a.75.75 0 0 0 1.06.053L16.5 4.44v2.81a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0 0 1.5h2.553l-9.056 8.194a.75.75 0 0 0-.053 1.06Z\",\"clipRule\":\"evenodd\"}]]}]}]]}],\". Both of these are extremely lightweight and the free tier is plenty for small sites.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"On the frontend, a script (hosted statically) is loaded on all pages and runs on every page load. The script caches a timestamp of first load in \",[\"$\",\"a\",null,{\"href\":\"https://developer.mozilla.org/en-US/docs/Web/API/Window/sessionStorage\",\"target\":\"_blank\",\"rel\":\"noopener\",\"className\":\"inline\",\"children\":[\"SessionStorage\",[\"$\",\"span\",null,{\"className\":\"inline pl-1 select-none aria-hidden\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 20 20\",\"fill\":\"currentColor\",\"aria-hidden\":\"true\",\"data-slot\":\"icon\",\"aria-labelledby\":\"$undefined\",\"className\":\"inline w-3 h-3\",\"children\":[null,[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Z\",\"clipRule\":\"evenodd\"}],[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M6.194 12.753a.75.75 0 0 0 1.06.053L16.5 4.44v2.81a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0 0 1.5h2.553l-9.056 8.194a.75.75 0 0 0-.053 1.06Z\",\"clipRule\":\"evenodd\"}]]}]}]]}],\" (which clears when the tab is closed).\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Every time the script is run, it sends a POST request to the Netlify Function with the timestamp (as a de-facto session ID) and the basic data I'm looking for (in this case, the page path and user agent).\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"On the backend, MongoDB Compass can parse and analyze the data \",[\"$\",\"a\",null,{\"href\":\"https://www.mongodb.com/docs/compass/current/schema/\",\"target\":\"_blank\",\"rel\":\"noopener\",\"className\":\"inline\",\"children\":[\"directly from the database\",[\"$\",\"span\",null,{\"className\":\"inline pl-1 select-none aria-hidden\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 20 20\",\"fill\":\"currentColor\",\"aria-hidden\":\"true\",\"data-slot\":\"icon\",\"aria-labelledby\":\"$undefined\",\"className\":\"inline w-3 h-3\",\"children\":[null,[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Z\",\"clipRule\":\"evenodd\"}],[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M6.194 12.753a.75.75 0 0 0 1.06.053L16.5 4.44v2.81a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0 0 1.5h2.553l-9.056 8.194a.75.75 0 0 0-.053 1.06Z\",\"clipRule\":\"evenodd\"}]]}]}]]}],\". You can also always create a frontend for the data in your database. There is full data independence.\"]}],\"\\n\",[[\"$\",\"span\",null,{\"id\":\"1.-mongodb\"}],[\"$\",\"h3\",null,{\"children\":[\"$\",\"$L12\",null,{\"href\":\"#1.-mongodb\",\"className\":\"after:content-['#'] after:ml-2 after:invisible hover:after:visible after:font-light after:text-base\",\"children\":\"1. MongoDB\"}]}]],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Create a database and a collection. Then, create a user scoped to only read/write to that database/collection.\"}],\"\\n\",[[\"$\",\"span\",null,{\"id\":\"2.-netlify-functions\"}],[\"$\",\"h3\",null,{\"children\":[\"$\",\"$L12\",null,{\"href\":\"#2.-netlify-functions\",\"className\":\"after:content-['#'] after:ml-2 after:invisible hover:after:visible after:font-light after:text-base\",\"children\":\"2. Netlify Functions\"}]}]],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Using GitHub, I create a basic repo with a \",[\"$\",\"code\",null,{\"children\":\"/netlify/functions/postDb.js\"}],\" file. \",[\"$\",\"a\",null,{\"href\":\"https://docs.netlify.com/functions/build/?fn-language=js\",\"target\":\"_blank\",\"rel\":\"noopener\",\"className\":\"inline\",\"children\":[\"Following the Netlify docs\",[\"$\",\"span\",null,{\"className\":\"inline pl-1 select-none aria-hidden\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 20 20\",\"fill\":\"currentColor\",\"aria-hidden\":\"true\",\"data-slot\":\"icon\",\"aria-labelledby\":\"$undefined\",\"className\":\"inline w-3 h-3\",\"children\":[null,[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Z\",\"clipRule\":\"evenodd\"}],[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M6.194 12.753a.75.75 0 0 0 1.06.053L16.5 4.44v2.81a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0 0 1.5h2.553l-9.056 8.194a.75.75 0 0 0-.053 1.06Z\",\"clipRule\":\"evenodd\"}]]}]}]]}],\", I write some code to accept a JSON payload, and then send it into my database.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Note that if your website isn't hosted here, you will need to \",[\"$\",\"a\",null,{\"href\":\"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS/Errors/CORSMissingAllowOrigin\",\"target\":\"_blank\",\"rel\":\"noopener\",\"className\":\"inline\",\"children\":[\"manually allow the domain(s)\",[\"$\",\"span\",null,{\"className\":\"inline pl-1 select-none aria-hidden\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 20 20\",\"fill\":\"currentColor\",\"aria-hidden\":\"true\",\"data-slot\":\"icon\",\"aria-labelledby\":\"$undefined\",\"className\":\"inline w-3 h-3\",\"children\":[null,[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Z\",\"clipRule\":\"evenodd\"}],[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M6.194 12.753a.75.75 0 0 0 1.06.053L16.5 4.44v2.81a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0 0 1.5h2.553l-9.056 8.194a.75.75 0 0 0-.053 1.06Z\",\"clipRule\":\"evenodd\"}]]}]}]]}],\" you're using, due to CORS.\"]}],\"\\n\",[\"$\",\"details\",null,{\"children\":[[\"$\",\"summary\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"cursor-pointer\",\"children\":\"/netlify/functions/postDb.js\"}]}],[\"$\",\"pre\",null,{\"className\":\"whitespace-normal\",\"children\":[\"$\",\"code\",null,{\"className\":\"whitespace-pre-wrap\",\"children\":\"$13\"}]}]]}],\"\\n\",[[\"$\",\"span\",null,{\"id\":\"3.-frontend-script\"}],[\"$\",\"h3\",null,{\"children\":[\"$\",\"$L12\",null,{\"href\":\"#3.-frontend-script\",\"className\":\"after:content-['#'] after:ml-2 after:invisible hover:after:visible after:font-light after:text-base\",\"children\":\"3. Frontend Script\"}]}]],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Save this script with your website, then load it on every page. It uses \",[\"$\",\"a\",null,{\"href\":\"https://developer.mozilla.org/en-US/docs/Web/API/Navigator/sendBeacon\",\"target\":\"_blank\",\"rel\":\"noopener\",\"className\":\"inline\",\"children\":[\"Navigator.sendBeacon()\",[\"$\",\"span\",null,{\"className\":\"inline pl-1 select-none aria-hidden\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 20 20\",\"fill\":\"currentColor\",\"aria-hidden\":\"true\",\"data-slot\":\"icon\",\"aria-labelledby\":\"$undefined\",\"className\":\"inline w-3 h-3\",\"children\":[null,[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Z\",\"clipRule\":\"evenodd\"}],[\"$\",\"path\",null,{\"fillRule\":\"evenodd\",\"d\":\"M6.194 12.753a.75.75 0 0 0 1.06.053L16.5 4.44v2.81a.75.75 0 0 0 1.5 0v-4.5a.75.75 0 0 0-.75-.75h-4.5a.75.75 0 0 0 0 1.5h2.553l-9.056 8.194a.75.75 0 0 0-.053 1.06Z\",\"clipRule\":\"evenodd\"}]]}]}]]}],\" to send data, even after the tab closes.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Note that you can ignore a device by setting \\\"analyticsIgnore\\\" to \\\"true\\\" in LocalStorage. Some adblockers, such as those using EasyPrivacy, may also block Navigator.sendBeacon().\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"For frameworks (e.g. React, Vue, Svelte), you can set middleware to post a Navigator.sendBeacon() on every route change.\"}],\"\\n\",[\"$\",\"details\",null,{\"children\":[[\"$\",\"summary\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"cursor-pointer\",\"children\":\"index.js\"}]}],[\"$\",\"pre\",null,{\"className\":\"whitespace-normal\",\"children\":[\"$\",\"code\",null,{\"className\":\"whitespace-pre-wrap\",\"children\":\"$14\"}]}]]}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"Results\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"I was pleasantly surprised at how nicely this setup worked. The benefits are great:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"MongoDB comes with powerful tools, so everything works out-of-the-box.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"You own the database, so you have full data independence, and can host it anywhere.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"You create the API, so you can easily customize what data you want to collect and store.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Since there is no server, nothing ever goes \\\"out of date\\\", go \\\"down\\\" for maintenance, or racking up expensive server costs on traffic spikes.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"This journey has walked us through NoSQL databases, protecting your MongoDB login using Node.js (Netlify Functions), and using browser APIs to persist and send data across pages.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Some enhancements to consider are ratelimiting the Netlify Function, mandating MongoDB schema, and validating data.\"}],\"\\n\",[\"$\",\"h1\",null,{\"children\":\"About\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Cats.js stands for \\\"Coffeebank Analytics Tracking Solution - JavaScript\\\".\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Yes, I also happen to like cats.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"$L12\",null,{\"href\":\"/projects/catsjs/license\",\"children\":\"License: MIT - See License\"}],\". Hope this is helpful for your analytics needs!\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"!text-sm\",\"children\":\"Last Updated: December 27, 2022\"}]]}]]}],null],\"segment\":\"__PAGE__\"},\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/bc1646f45069080b.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}],\"segment\":\"catsjs\"},\"styles\":[]}],\"segment\":\"projects\"},\"styles\":[]}]}]}]]}]}],null],\"segment\":\"(home)\"},\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/db19166c1fb6b326.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/6c9015bfdf3d2785.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}],null]}]]\n"])</script><script>self.__next_f.push([1,"7:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"cats.js | ☕🏦\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"A simple, privacy-friendly, self-hosted analytics solution for websites.\"}],[\"$\",\"meta\",\"3\",{\"name\":\"theme-color\",\"content\":\"#293658\"}],[\"$\",\"meta\",\"4\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"5\",{\"name\":\"og:image\",\"content\":\"https://coffeebank.netlify.app/home/media/avinash-kumar-TIGDsyy0TK4-unsplash_c01_twitter.jpg\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:title\",\"content\":\"cats.js: Website Analytics\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:description\",\"content\":\"A simple, privacy-friendly, self-hosted analytics solution for websites.\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:site_name\",\"content\":\"Coffeebank ☕\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:image\",\"content\":\"https://coffeebank.netlify.app/home/media/avinash-kumar-TIGDsyy0TK4-unsplash_c01_twitter.jpg\"}],[\"$\",\"meta\",\"10\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:title\",\"content\":\"cats.js: Website Analytics\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:description\",\"content\":\"A simple, privacy-friendly, self-hosted analytics solution for websites.\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:image\",\"content\":\"https://coffeebank.netlify.app/home/media/avinash-kumar-TIGDsyy0TK4-unsplash_c01_twitter.jpg\"}],[\"$\",\"link\",\"14\",{\"rel\":\"shortcut icon\",\"href\":\"/icon.png\"}],[\"$\",\"link\",\"15\",{\"rel\":\"icon\",\"href\":\"/icon.png\"}],[\"$\",\"link\",\"16\",{\"rel\":\"apple-touch-icon\",\"href\":\"/icon.png\"}],[\"$\",\"meta\",\"17\",{\"name\":\"next-size-adjust\"}]]\n"])</script><script>self.__next_f.push([1,"f:null\n"])</script></body></html>